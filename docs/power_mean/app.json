[{"name":"app.R","content":"library(shiny)\r\n\r\nui <- fluidPage(\r\n\r\n    # Application title\r\n    titlePanel(\"One Tail vs Two Tail Test Power: H_0: μ=20\"),\r\n\r\n    # Sidebar\r\n    sidebarLayout(\r\n        sidebarPanel(\r\n          sliderInput(\"sigma\",\r\n                      \"pop sd:\",\r\n                      min = 5,\r\n                      max = 25,\r\n                      value = 10),\r\n          sliderInput(\"n\",\r\n                      \"sample size:\",\r\n                      min = 5,\r\n                      max = 100,\r\n                      value = 20),\r\n          sliderInput(\"mu\",\r\n                        \"True μ:\",\r\n                        min = 0,\r\n                        max = 40,\r\n                        value = 20),\r\n            sliderInput(\"alpha\",\r\n                        \"α:\",\r\n                        min = 0.001,\r\n                        max = .2,\r\n                        value = .05),\r\n            radioButtons( \r\n              inputId = \"testType\", \r\n              label = \"Test Type\", \r\n              choices = list( \r\n                \"Lower Tail\" = 1, \r\n                \"Two Tail\" = 2, \r\n                \"Right Tail\" = 3 \r\n              ) \r\n            ), \r\n        ),\r\n\r\n        # Show a plot of the generated plots\r\n        mainPanel(\r\n           plotOutput(\"distPlot\")\r\n        ),\r\n        position = c(\"left\", \"right\"),\r\n        fluid = TRUE\r\n    )\r\n)\r\n\r\n# Define server logic required to draw a histogram\r\nserver <- function(input, output) {\r\n  \r\n    output$distPlot <- renderPlot({\r\n      n = input$n\r\n      alpha = input$alpha\r\n      sigma = input$sigma\r\n      \r\n      RRl=NA; RRr=NA\r\n      if(input$testType==1) RRl=qnorm(alpha, 20, sigma/sqrt(n))\r\n      if(input$testType==2) RRl=qnorm(alpha/2, 20, sigma/sqrt(n))\r\n      if(input$testType==2) RRr=qnorm(1-alpha/2, 20, sigma/sqrt(n))\r\n      if(input$testType==3) RRr=qnorm(1-alpha, 20, sigma/sqrt(n))\r\n      \r\n      par(mfrow=c(2,1))\r\n      par(mar = c(0,4,1,1) + 0.2)\r\n      x <- seq(0,40, length.out=300); \r\n      px <- dnorm(x,20,sigma/sqrt(n));\r\n      plot(y=px, x=x, type=\"l\", col=\"gray\", xaxt=\"n\", ylab=\"density\")\r\n      pxA <- dnorm(x,input$mu, sigma/sqrt(n));\r\n      if(!is.na(RRl)) polygon(y=c(pxA[x<=RRl],0,0), x=c((x[x<=RRl]),RRl,0), col=\"pink\", border=NA)\r\n      if(!is.na(RRr)) polygon(y=c(pxA[x>=RRr],0,0), x=c((x[x>=RRr]),0,RRr), col=\"pink\", border=NA)\r\n      lines(y=pxA, x=(x), type=\"l\")\r\n      abline(v=c(RRl,RRr), col=\"red\")\r\n      text(x=20, y=dnorm(20,20,sigma/sqrt(n)), \"X-bar (H0)\", col=\"darkgray\", pos=1)\r\n      text(x=input$mu, y=dnorm(20,20,sigma/sqrt(n))*.85, \"X-bar (true)\", col=\"black\", pos=1)\r\n      if(!is.na(RRl)) text(x=RRl, y=dnorm(20,20,sigma/sqrt(n))/3, pos=2, \"Rejection Region\", col=\"red\")\r\n      if(!is.na(RRr)) text(x=RRr, y=dnorm(20,20,sigma/sqrt(n))/3, pos=4, \"Rejection Region\", col=\"red\")\r\n      \r\n      muAlt <- seq(0,40,by=.005)\r\n      RR <- rep(0, length(muAlt))\r\n      power <- 0\r\n      if(input$testType<=2){\r\n        RR <- pnorm(RRl, mean=muAlt, sd=sigma/sqrt(n))\r\n        power <- pnorm(RRl, mean=input$mu, sd=sigma/sqrt(n))\r\n      } \r\n      if (input$testType>=2){\r\n        RR <- RR + pnorm(RRr, mean=muAlt, sd=sigma/sqrt(n), lower.tail=F)\r\n        power <- power + pnorm(RRr, mean=input$mu, sd=sigma/sqrt(n), lower.tail=F)\r\n      }\r\n\r\n      par(mar = c(2,4,1,1) + 0.2)\r\n      plot(x=muAlt, y=RR, type=\"l\", ylab=\"rejection rate\", xlab=\"true mu\", ylim=c(0,1))\r\n      abline(h=alpha, col=\"red\",lty=2)\r\n      points(x=input$mu, y=power)\r\n      align <- 1\r\n      if(power<.5) align <-3\r\n      text(x=input$mu, y=power, paste0(\"Power=\",round(power,3)),pos=align)\r\n    })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
