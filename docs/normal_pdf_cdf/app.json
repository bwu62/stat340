[{"name":"app.R","content":"library(shiny)\r\n\r\nrange = 6\r\nexpd = 0.005\r\n\r\n# Define UI for application that draws a histogram\r\nui <- fluidPage(\r\n\r\n    # Application title\r\n    titlePanel(\"Normal CDF, PDF, & inverse CDF\"),\r\n\r\n    # Sidebar \r\n    sidebarLayout(\r\n      inputPanel(\r\n        sliderInput(\"mu\", label=\"Mean\",min=-range,max=range,value=0,step=0.1),\r\n        sliderInput(\"sigma2\", label=\"Variance\",min=.01,max=10,value=1,step=.01),\r\n        sliderInput(\"x\", label=\"x\",min=-range,max=range,value=0,step=0.01)\r\n      ),\r\n\r\n      # Show a plot of the generated distribution\r\n      mainPanel(\r\n         plotOutput(\"mainPlot\")\r\n      )\r\n    )\r\n)\r\n\r\n# Define server logic required to draw a histogram\r\nserver <- function(input, output) {\r\n  output$mainPlot <- renderPlot({\r\n    par(mfrow=c(1,3))\r\n    xs <- seq(-6,6,length.out=200)\r\n    prob = round(pnorm(input$x, input$mu, sqrt(input$sigma2)),5)\r\n    plot(xs, dnorm(xs, input$mu, sqrt(input$sigma2)), type=\"l\", \r\n         main=\"Probability Density Function (PDF)\",\r\n         xlab=\"x\", ylab=\"density\", ylim=c(0, dnorm(0, sd=sqrt(input$sigma2))))\r\n    polygon(c(-6,seq(-6, input$x, by=.01), input$x), \r\n            c(0,dnorm(seq(-6, input$x, by=.01), input$mu, sqrt(input$sigma2)),0), col=\"pink\")\r\n    text(x=6, y=dnorm(0, sd=sqrt(input$sigma2)), \r\n         paste(\"Area:\",prob), pos=2)\r\n\r\n    plot(xs, pnorm(xs, input$mu, sqrt(input$sigma2)), type=\"l\", \r\n         main=\"Cumulative density function (CDF)\",\r\n         xlab=\"x\", ylab=\"probability\", ylim=c(0, 1))\r\n    points(input$x, pnorm(input$x, input$mu, sqrt(input$sigma2)), col=\"red\", pch=16)\r\n\r\n    plot(seq(0.001,.999,.001), qnorm(seq(0.001,.999,.001), input$mu, sqrt(input$sigma2)), type=\"l\", \r\n         main=\"Inverse CDF\",\r\n         xlab=\"probability\", ylab=\"x\", xlim=c(0, 1), ylim=c(-6,6))\r\n    points(pnorm(input$x, input$mu, sqrt(input$sigma2)), input$x, col=\"red\", pch=16)\r\n    \r\n        \r\n#    g1 <- ggplot()+stat_function(fun=~{dnorm(.x,input$mu,input$sigma2)},n=1001)+\r\n#      scale_x_continuous(expand=c(0,0),limits=c(-range,range)) + \r\n#      scale_y_continuous(expand=c(expd,expd)) + \r\n#      geom_point(aes(x=input$x,y=dnorm(input$x,input$mu,input$sigma2)),color=\"red\",size=4) + \r\n#      stat_function(fun=~{dnorm(.x,input$mu,input$sigma2)},n=1001,geom=\"area\",xlim=c(-100,input$x),fill=\"red\",alpha=.5)+\r\n#      labs(title=\"Probability density function (PDF)\",x=\"x\",y=\"Density\")\r\n#    g2 <- \r\n#    ggplot()+geom_function(fun=~{pnorm(.x,input$mu,input$sigma2)},n=1001)+\r\n#      geom_point(aes(x=input$x,y=pnorm(input$x,input$mu,input$sigma2)),color=\"red\",size=4) +\r\n#      scale_x_continuous(expand=c(expd,expd),limits=c(-range,range)) + scale_y_continuous(expand=c(expd,0)) + \r\n#      labs(title=\"Cumulative density function (CDF)\",x=\"x\",y=\"Probability\")\r\n#    g3 <- ggplot()+geom_function(fun=~{qnorm(.x,input$mu,input$sigma2)},n=1001)+\r\n#      geom_point(aes(x=pnorm(input$x,input$mu,input$sigma2),y=input$x),color=\"red\",size=4) +\r\n#      scale_x_continuous(expand=c(expd,expd),limits=c(0,1)) + \r\n#    scale_y_continuous(expand=c(expd,expd),limits=c(-range,range)) + \r\n#      labs(title=\"Inverse CDF\",x=\"Probability\",y=\"x\")\r\n#    grid.arrange(g1,g2,g3,nrow=1)\r\n    \r\n    },height=300)\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
