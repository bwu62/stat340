[{"name":"app.R","content":"library(shiny)\r\nsigma <- 10\r\n\r\nui <- fluidPage(\r\n\r\n    # Application title\r\n    titlePanel(\"Variance Test Power: H₀: σ²=10\"),\r\n\r\n    # Sidebar\r\n    sidebarLayout(\r\n        sidebarPanel(\r\n          sliderInput(\"n\",\r\n                      \"sample size:\",\r\n                      min = 3,\r\n                      max = 60,\r\n                      value = 15,\r\n                      step=1),\r\n          sliderInput(\"s2\",\r\n                        \"True σ²:\",\r\n                        min = 1,\r\n                        max = 30,\r\n                        value = 10),\r\n            sliderInput(\"alpha\",\r\n                        \"α:\",\r\n                        min = 0.001,\r\n                        max = .2,\r\n                        value = .05),\r\n            radioButtons( \r\n              inputId = \"testType\", \r\n              label = \"Test Type\", \r\n              choices = list( \r\n                \"Lower Tail\" = 1, \r\n                \"Two Tail\" = 2, \r\n                \"Right Tail\" = 3 \r\n              ) \r\n            ), \r\n        ),\r\n\r\n        # Show a plot of the generated plots\r\n        mainPanel(\r\n           plotOutput(\"distPlot\")\r\n        ),\r\n        position = c(\"left\", \"right\"),\r\n        fluid = TRUE\r\n    )\r\n)\r\n\r\n# Define server logic required to draw a histogram\r\nserver <- function(input, output) {\r\n\r\n    output$distPlot <- renderPlot({\r\n      RRl=NA; RRr=NA\r\n      df=input$n-1\r\n      if(input$testType==1) RRl=qchisq(input$alpha, df)*10/df\r\n      if(input$testType==2) RRl=qchisq(input$alpha/2, df)*10/df\r\n      if(input$testType==2) RRr=qchisq(1-input$alpha/2, df)*10/df\r\n      if(input$testType==3) RRr=qchisq(1-input$alpha, df)*10/df\r\n      \r\n      par(mfrow=c(2,1))\r\n      par(mar = c(0,4,1,1) + 0.1)\r\n      x <- seq(0,40, length.out=300); \r\n      px <- dchisq(x*df/10,df);\r\n      pxA <- dchisq(x*df/input$s2, df)*10/input$s2;\r\n      scaleHeight = max(c(px, pxA))\r\n      print(scaleHeight)\r\n      \r\n      plot(y=px, x=x, type=\"l\", col=\"darkgray\", xaxt=\"n\", ylab=\"density\", ylim=c(0, scaleHeight))\r\n      if(!is.na(RRl)) polygon(y=c(pxA[x<=RRl],0,0)*ifelse(input$s2<19,1,10/input$s2), x=c((x[x<=RRl]),RRl,0), col=\"pink\", border=NA)\r\n      if(!is.na(RRr)) polygon(y=c(pxA[x>=RRr],0,0)*ifelse(input$s2<19,1,10/input$s2), x=c((x[x>=RRr]),40,RRr), col=\"pink\", border=NA)\r\n      lines(y=pxA*ifelse(input$s2<19,1,10/input$s2), x=(x), type=\"l\")\r\n      abline(v=c(RRl,RRr), col=\"red\")\r\n      segments(x0=10,y0=0, y1=-1, col=\"darkgray\")\r\n      segments(x0=input$s2, y0=0, y1=-1, col=\"black\")\r\n      text(x=10, y=dchisq(df,df), \"S² (H₀)\", col=\"darkgray\", pos=1)\r\n      text(x=input$s2, y=dchisq(df,df)*.85, \"S² (true)\", col=\"black\", pos=1)\r\n      if(!is.na(RRl)) text(x=RRl, y=dchisq(df,df)/3, pos=2, \"Rejection\\n Region\", col=\"red\")\r\n      if(!is.na(RRr)) text(x=RRr, y=dchisq(df,df)/3, pos=4, \"Rejection\\n Region\", col=\"red\")\r\n      \r\n      s2alt <- seq(0,40,by=.005)\r\n      RR <- rep(0, length(s2alt))\r\n      power <- 0\r\n      if(input$testType<=2){\r\n        RR <- pchisq(RRl*df/s2alt, df)\r\n        power <- pchisq(RRl*df/input$s2, df)\r\n      } \r\n      if (input$testType>=2){\r\n        RR <- RR + pchisq(RRr*df/s2alt, df, lower.tail=F)\r\n        power <- power + pchisq(RRr*df/input$s2, df, lower.tail=F)\r\n      }\r\n      par(mar = c(2,4,1,1) + 0.1)\r\n      \r\n      plot(x=s2alt, y=RR, type=\"l\", ylab=\"rejection rate\", xlab=\"true variance\", ylim=c(0,1))\r\n      abline(h=input$alpha, col=\"red\",lty=2)\r\n      points(x=input$s2, y=power)\r\n      align <- 1\r\n      if(power<.5) align <-3\r\n      text(x=input$s2, y=power, paste0(\"Power=\",round(power,3)),pos=align)\r\n    })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
